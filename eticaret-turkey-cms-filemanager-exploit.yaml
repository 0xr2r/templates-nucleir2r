id: eticaret-turkey-cms-filemanager-exploit

info:
  name: Eticaret Turkey CMS File Manager Exploit
  author: 0xr2r
  severity: critical
  description: |
    This template detects potential vulnerabilities in the Eticaret Turkey CMS through exploitable file manager endpoints like Kcfinder and Roxy Filemanager.
  tags: filemanager,eticaret,exploit
  reference:
    - https://github.com/iskinucarx/eticaret

http:
  - raw:
      - |
        GET /nedmin/production/ckeditor/kcfinder/upload.php HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "kcfinder"
          - "upload"
        part: body

  - raw:
      - |
        GET /nedmin/production/fileman/index.html HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "Roxy Filemanager"
          - "index.html"
        part: body
